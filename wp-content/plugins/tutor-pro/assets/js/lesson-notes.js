(()=>{"use strict";function t(e){"@babel/helpers - typeof";return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,r(n.key),n)}}function n(t,e,n){return e&&o(t.prototype,e),n&&o(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function r(e){var o=i(e,"string");return"symbol"==t(o)?o:o+""}function i(e,o){if("object"!=t(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,o||"default");if("object"!=t(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===o?String:Number)(e)}var a=function(){function t(o){e(this,t);this.content=o}return n(t,[{key:"highlightSelection",value:function t(){var e=window.getSelection();if(!e.rangeCount||e.isCollapsed)return;var o=e.getRangeAt(0);if(!this.content.contains(o.commonAncestorContainer))return;var n=o.toString();var r=this.getAbsolutePosition(o.startContainer,o.startOffset);var i=this.getAbsolutePosition(o.endContainer,o.endOffset);var a={id:this.getRandomInt(1,500),text:n===null||n===void 0?void 0:n.trim(),startPos:r,endPos:i,color:this.currentColor,fingerprint:this.createFingerprint(n,r),timestamp:Date.now()};this.extractedHighlight(o);return a}},{key:"extractedHighlight",value:function t(e){if(this.rangeSpansBlockElements(e)){this.applyInlineHighlight(e)}else{var o=document.createElement("mark");o.className="tutor-highlighted";try{e.surroundContents(o)}catch(t){var n=e.extractContents();o.appendChild(n);e.insertNode(o)}}}},{key:"rangeSpansBlockElements",value:function t(e){var o=["P","DIV","H1","H2","H3","H4","H5","H6","LI","BLOCKQUOTE","PRE"];var n=e.startContainer;while(n&&n!==e.endContainer){if(n.nodeType===Node.ELEMENT_NODE&&o.includes(n.tagName)){return true}n=this.getNextNode(n,e.commonAncestorContainer)}return false}},{key:"getNextNode",value:function t(e,o){if(e.firstChild)return e.firstChild;while(e){if(e===o)return null;if(e.nextSibling)return e.nextSibling;e=e.parentNode}return null}},{key:"applyInlineHighlight",value:function t(e){var o=this.getTextNodesInRange(e);o.forEach(function(t){var e=t.node,o=t.startOffset,n=t.endOffset;if(o>=n)return;var r=document.createRange();r.setStart(e,o);r.setEnd(e,n);var i=document.createElement("mark");i.className="tutor-highlighted";try{r.surroundContents(i)}catch(t){var a=r.extractContents();i.appendChild(a);r.insertNode(i)}});window.getSelection().removeAllRanges()}},{key:"applyInlineHighlightWithNote",value:function t(e,o){var n=this;var r=this.getTextNodesInRange(e);r.forEach(function(t,e){var r=t.node,i=t.startOffset,a=t.endOffset;if(i>=a)return;var s=document.createRange();s.setStart(r,i);s.setEnd(r,a);n.insertMarker(s,o)})}},{key:"removeHighlight",value:function t(e){var o=e.startContainer.parentNode;if(o&&o.classList.contains("tutor-highlighted")){var n=document.createTextNode(e.toString());o.parentNode.replaceChild(n,o)}}},{key:"createFingerprint",value:function t(e,o){var n=this.content.textContent;var r=50;var i=n.substring(Math.max(0,o-r),o);var a=n.substring(o+e.length,Math.min(n.length,o+e.length+r));var s={full:this.hash(i+e+a),beforeText:this.hash(i+e),textAfter:this.hash(e+a),textOnly:this.hash(e),wordContext:this.getWordContext(e,o)};return s}},{key:"hash",value:function t(e){var t=0;for(var o=0;o<e.length;o++){var n=e.charCodeAt(o);t=(t<<5)-t+n;t=t&t}return t.toString(36)}},{key:"getWordContext",value:function t(e,o){var n=this.content.textContent;var r=n.split(/\s+/);var i=e.split(/\s+/);for(var a=0;a<=r.length-i.length;a++){var s=r.slice(a,a+i.length);if(s.join(" ").includes(e.trim())){var l=r.slice(Math.max(0,a-3),a);var u=r.slice(a+i.length,a+i.length+3);return{before:l.join(" "),after:u.join(" "),position:a}}}return null}},{key:"getAbsolutePosition",value:function t(e,o){var n=0;var r=document.createTreeWalker(this.content,NodeFilter.SHOW_TEXT,null);var i;while(i=r.nextNode()){if(i===e){return n+o}n+=i.textContent.length}return n}},{key:"getNodeFromPosition",value:function t(e){var o=0;var n=document.createTreeWalker(this.content,NodeFilter.SHOW_TEXT,null);var r;while(r=n.nextNode()){var i=r.textContent.length;if(o+i>=e){return{node:r,offset:e-o}}o+=i}return null}},{key:"restoreHighlight",value:function t(e){var o=this.content.textContent;var n=e.highlight_serialized;if(n.startPos<o.length&&n.endPos<=o.length&&o.substring(n.startPos,n.endPos)===n.text){if(this.applyHighlightAtPosition(n.startPos,e)){return true}}var r=o.length-n.startPos;var i=o.length-r;if(i>=0&&i+n.text.length<=o.length&&o.substring(i,i+n.text.length)===n.text){if(this.applyHighlightAtPosition(i,e)){return true}}return this.restoreByFingerprint(n,e)}},{key:"applyHighlightAtPosition",value:function t(e,o){var n=o.highlight_text;var r=this.getNodeFromPosition(e);var i=this.getNodeFromPosition(e+(n===null||n===void 0?void 0:n.length));if(r&&i){try{var a=document.createRange();a.setStart(r.node,r.offset);a.setEnd(i.node,i.offset);if(this.rangeSpansBlockElements(a)){this.applyInlineHighlightWithNote(a,o);return true}else{this.insertMarker(a,o);return true}}catch(t){console.warn("Could not apply highlight at position:",e,t);return false}}return false}},{key:"restoreByFingerprint",value:function t(e,o){var n=this.content.textContent;var r=e.text;var i=[];var a=n.indexOf(r);while(a!==-1){i.push(a);a=n.indexOf(r,a+1)}for(var s=0,l=i;s<l.length;s++){var u=l[s];var c=this.createFingerprint(r,u);var d=[c.full===e.fingerprint.full,c.beforeText===e.fingerprint.beforeText,c.textAfter===e.fingerprint.textAfter,this.matchWordContext(c.wordContext,e.fingerprint.wordContext)];if(d[0]||d[1]||d[2]||d[3]){if(this.applyHighlightAtPosition(u,o)){return true}}}if(i.length>0){return this.applyHighlightAtPosition(i[0],o)}return false}},{key:"matchWordContext",value:function t(e,o){if(!e||!o)return false;return e.before===o.before&&e.after===o.after}},{key:"applyComplexHighlight",value:function t(e,o){var n=this;var r=o.highlight_serialized.id;var i=this.getTextNodesInRange(e);if(i.length===0)return;i.forEach(function(t,r){try{if(r==i.length-1){n.insertMarker(e,o)}}catch(t){}});this.content.normalize()}},{key:"insertMarker",value:function t(e,o,n){var r=document.createElement("mark");r.className="".concat(n!==null&&n!==void 0?n:"tutor-highlighted has-note");r.dataset.noteId=o.comment_ID;r.dataset.lessonId=o.comment_post_ID;r.dataset.noteContent=o.comment_content;r.dataset.highlightText=o.highlight_text;r.dataset.highlightId=o.highlight_serialized.id;try{e.surroundContents(r)}catch(t){var i=e.extractContents();r.appendChild(i);e.insertNode(r)}}},{key:"getTextNodesInRange",value:function t(e){var o=[];var n=document.createTreeWalker(e.commonAncestorContainer,NodeFilter.SHOW_TEXT,null);var r;while(r=n.nextNode()){if(!r.textContent||!r.textContent.trim())continue;var i=document.createRange();i.selectNodeContents(r);if(e.compareBoundaryPoints(Range.END_TO_START,i)>0||e.compareBoundaryPoints(Range.START_TO_END,i)<0){continue}var a=0;var s=r.textContent.length;if(r===e.startContainer){a=e.startOffset}else{try{if(e.comparePoint(r,0)>0){continue}}catch(t){var l=document.createRange();l.setStart(r,0);if(e.compareBoundaryPoints(Range.START_TO_START,l)>0){continue}}}if(r===e.endContainer){s=e.endOffset}else{try{if(e.comparePoint(r,r.textContent.length)<0){continue}}catch(t){var u=document.createRange();u.setEnd(r,r.textContent.length);if(e.compareBoundaryPoints(Range.END_TO_END,u)<0){continue}}}if(a<s){o.push({node:r,startOffset:a,endOffset:s})}}return o}},{key:"getRandomInt",value:function t(e,o){e=Math.ceil(e);o=Math.floor(o);return Math.floor(Math.random()*(o-e+1))+e}}])}();const s=a;function l(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var t,e,o="function"==typeof Symbol?Symbol:{},n=o.iterator||"@@iterator",r=o.toStringTag||"@@toStringTag";function i(o,n,r,i){var l=n&&n.prototype instanceof s?n:s,c=Object.create(l.prototype);return u(c,"_invoke",function(o,n,r){var i,s,l,u=0,c=r||[],d=!1,f={p:0,n:0,v:t,a:v,f:v.bind(t,4),d:function e(o,n){return i=o,s=0,l=t,f.n=n,a}};function v(o,n){for(s=o,l=n,e=0;!d&&u&&!r&&e<c.length;e++){var r,i=c[e],v=f.p,h=i[2];o>3?(r=h===n)&&(l=i[(s=i[4])?5:(s=3,3)],i[4]=i[5]=t):i[0]<=v&&((r=o<2&&v<i[1])?(s=0,f.v=n,f.n=i[1]):v<h&&(r=o<3||i[0]>n||n>h)&&(i[4]=o,i[5]=n,f.n=h,s=0))}if(r||o>1)return a;throw d=!0,n}return function(r,c,h){if(u>1)throw TypeError("Generator is already running");for(d&&1===c&&v(c,h),s=c,l=h;(e=s<2?t:l)||!d;){i||(s?s<3?(s>1&&(f.n=-1),v(s,l)):f.n=l:f.v=l);try{if(u=2,i){if(s||(r="next"),e=i[r]){if(!(e=e.call(i,l)))throw TypeError("iterator result is not an object");if(!e.done)return e;l=e.value,s<2&&(s=0)}else 1===s&&(e=i["return"])&&e.call(i),s<2&&(l=TypeError("The iterator does not provide a '"+r+"' method"),s=1);i=t}else if((e=(d=f.n<0)?l:o.call(n,f))!==a)break}catch(e){i=t,s=1,l=e}finally{u=1}}return{value:e,done:d}}}(o,r,i),!0),c}var a={};function s(){}function c(){}function d(){}e=Object.getPrototypeOf;var f=[][n]?e(e([][n]())):(u(e={},n,function(){return this}),e),v=d.prototype=s.prototype=Object.create(f);function h(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,r,"GeneratorFunction")),t.prototype=Object.create(v),t}return c.prototype=d,u(v,"constructor",d),u(d,"constructor",c),c.displayName="GeneratorFunction",u(d,r,"GeneratorFunction"),u(v),u(v,r,"Generator"),u(v,n,function(){return this}),u(v,"toString",function(){return"[object Generator]"}),(l=function t(){return{w:i,m:h}})()}function u(t,e,o,n){var r=Object.defineProperty;try{r({},"",{})}catch(t){r=0}u=function t(e,o,n,i){function a(t,o){u(e,t,function(e){return this._invoke(t,o,e)})}o?r?r(e,o,{value:n,enumerable:!i,configurable:!i,writable:!i}):e[o]=n:(a("next",0),a("throw",1),a("return",2))},u(t,e,o,n)}function c(t,e,o,n,r,i,a){try{var s=t[i](a),l=s.value}catch(t){return void o(t)}s.done?e(l):Promise.resolve(l).then(n,r)}function d(t){return function(){var e=this,o=arguments;return new Promise(function(n,r){var i=t.apply(e,o);function a(t){c(i,n,r,a,s,"next",t)}function s(t){c(i,n,r,a,s,"throw",t)}a(void 0)})}}var f=function t(e){var o=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"yyyy-MM-dd HH:mm:ss";var n=e.getTimezoneOffset();var r=addMinutes(e,n);return format(r,o)};var v=function t(e){var o=new Date(e);var n=o.getTimezoneOffset();return addMinutes(o,-n)};var h=function t(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)};function p(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var e=new FormData;Object.keys(t).forEach(function(o){return e.set(o,t[o])});e.set(window.tutor_get_nonce_data(true).key,window.tutor_get_nonce_data(true).value);return e}function m(t){return g.apply(this,arguments)}function g(){g=d(l().m(function t(e){var o,n;return l().w(function(t){while(1)switch(t.p=t.n){case 0:t.p=0;t.n=1;return fetch(window._tutorobject.ajaxurl,{method:"POST",body:e});case 1:o=t.v;return t.a(2,o);case 2:t.p=2;n=t.v;tutor_toast(__("Operation failed","tutor-pro"),n,"error");case 3:return t.a(2)}},t,null,[[0,2]])}));return g.apply(this,arguments)}function y(t){"@babel/helpers - typeof";return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},y(t)}function b(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var t,e,o="function"==typeof Symbol?Symbol:{},n=o.iterator||"@@iterator",r=o.toStringTag||"@@toStringTag";function i(o,n,r,i){var l=n&&n.prototype instanceof s?n:s,u=Object.create(l.prototype);return _(u,"_invoke",function(o,n,r){var i,s,l,u=0,c=r||[],d=!1,f={p:0,n:0,v:t,a:v,f:v.bind(t,4),d:function e(o,n){return i=o,s=0,l=t,f.n=n,a}};function v(o,n){for(s=o,l=n,e=0;!d&&u&&!r&&e<c.length;e++){var r,i=c[e],v=f.p,h=i[2];o>3?(r=h===n)&&(l=i[(s=i[4])?5:(s=3,3)],i[4]=i[5]=t):i[0]<=v&&((r=o<2&&v<i[1])?(s=0,f.v=n,f.n=i[1]):v<h&&(r=o<3||i[0]>n||n>h)&&(i[4]=o,i[5]=n,f.n=h,s=0))}if(r||o>1)return a;throw d=!0,n}return function(r,c,h){if(u>1)throw TypeError("Generator is already running");for(d&&1===c&&v(c,h),s=c,l=h;(e=s<2?t:l)||!d;){i||(s?s<3?(s>1&&(f.n=-1),v(s,l)):f.n=l:f.v=l);try{if(u=2,i){if(s||(r="next"),e=i[r]){if(!(e=e.call(i,l)))throw TypeError("iterator result is not an object");if(!e.done)return e;l=e.value,s<2&&(s=0)}else 1===s&&(e=i["return"])&&e.call(i),s<2&&(l=TypeError("The iterator does not provide a '"+r+"' method"),s=1);i=t}else if((e=(d=f.n<0)?l:o.call(n,f))!==a)break}catch(e){i=t,s=1,l=e}finally{u=1}}return{value:e,done:d}}}(o,r,i),!0),u}var a={};function s(){}function l(){}function u(){}e=Object.getPrototypeOf;var c=[][n]?e(e([][n]())):(_(e={},n,function(){return this}),e),d=u.prototype=s.prototype=Object.create(c);function f(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,u):(t.__proto__=u,_(t,r,"GeneratorFunction")),t.prototype=Object.create(d),t}return l.prototype=u,_(d,"constructor",u),_(u,"constructor",l),l.displayName="GeneratorFunction",_(u,r,"GeneratorFunction"),_(d),_(d,r,"Generator"),_(d,n,function(){return this}),_(d,"toString",function(){return"[object Generator]"}),(b=function t(){return{w:i,m:f}})()}function _(t,e,o,n){var r=Object.defineProperty;try{r({},"",{})}catch(t){r=0}_=function t(e,o,n,i){function a(t,o){_(e,t,function(e){return this._invoke(t,o,e)})}o?r?r(e,o,{value:n,enumerable:!i,configurable:!i,writable:!i}):e[o]=n:(a("next",0),a("throw",1),a("return",2))},_(t,e,o,n)}function k(t,e,o,n,r,i,a){try{var s=t[i](a),l=s.value}catch(t){return void o(t)}s.done?e(l):Promise.resolve(l).then(n,r)}function w(t){return function(){var e=this,o=arguments;return new Promise(function(n,r){var i=t.apply(e,o);function a(t){k(i,n,r,a,s,"next",t)}function s(t){k(i,n,r,a,s,"throw",t)}a(void 0)})}}function S(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function L(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,E(n.key),n)}}function x(t,e,o){return e&&L(t.prototype,e),o&&L(t,o),Object.defineProperty(t,"prototype",{writable:!1}),t}function E(t){var e=C(t,"string");return"symbol"==y(e)?e:e+""}function C(t,e){if("object"!=y(t)||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!=y(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var N=function(){function t(){S(this,t);this.highlighter=null;this.defaultErrorMessage="";this.lessonWrapper=null;this.init()}return x(t,[{key:"init",value:function t(){var e,o=this;var n=wp.i18n.__;this.defaultErrorMessage=n("Something went wrong, please try again","tutor-pro");this.lessonWrapper=document.querySelector(".tutor-lesson-wrapper");this.highlighter=new s(this.lessonWrapper);(e=lesson_notes)===null||e===void 0||e.forEach(function(t){if(t.type==="highlight"){var e=o.decodeUnicodeEscapes(t.highlight_text);if(!t.highlight_text){t.highlight_text=e}if(!t.highlight_serialized){t.highlight_serialized.text=e}o.highlighter.restoreHighlight(t)}});this.setupEventListeners()}},{key:"decodeUnicodeEscapes",value:function t(e){if(!e)return"";e=e.replace(/u([0-9a-fA-F]{4})/g,function(t,e){return String.fromCharCode(parseInt(e,16))});var o=document.createElement("textarea");o.innerHTML=e;return o.value;{}}},{key:"getBlockAncestor",value:function t(e){if(!e)return null;if(e.nodeType===3)e=e.parentNode;while(e&&e!==document.body){var o=window.getComputedStyle(e).display;if(o==="block"||o==="list-item"||o==="table"){return e}e=e.parentNode}return null}},{key:"isInsideHighlight",value:function t(e){while(e&&e!==document.body){if(e.classList&&e.classList.contains("tutor-highlighted"))return true;e=e.parentNode}return false}},{key:"containsHighlight",value:function t(e){var o=document.createTreeWalker(e.commonAncestorContainer,NodeFilter.SHOW_ELEMENT,{acceptNode:function t(o){if(!e.intersectsNode(o))return NodeFilter.FILTER_REJECT;return o.classList&&o.classList.contains("tutor-highlighted")?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}},false);return o.nextNode()!==null}},{key:"getSelectionEndPosition",value:function t(){if(!this.lessonWrapper)return null;var e=window.getSelection();if(!e.rangeCount||e.isCollapsed)return null;var o=e.getRangeAt(0).cloneRange();if(!this.lessonWrapper.contains(o.startContainer))return null;if(this.isNoteFormOpen()){e.removeAllRanges();return null}if(this.isInsideHighlight(o.startContainer)||this.isInsideHighlight(o.endContainer)){return null}if(this.containsHighlight(o)){return null}var n=this.getBlockAncestor(o.startContainer);var r=this.getBlockAncestor(o.endContainer);if(!n||!r||n!==r){this.closeNoteForm(false);return null}o.collapse(false);var i=o.getBoundingClientRect();if(i){return{x:i.left,y:i.bottom}}return null}},{key:"getFormPosition",value:function t(e,o){var n=e.getBoundingClientRect();var r=o.getBoundingClientRect();var i=window.innerWidth;var a=window.innerHeight;var s=o.classList.contains("tutor-player-fullscreen");if(s){return{top:n.top-(r.height-n.height)+2,left:n.left-(r.width-n.width)+2}}var l=n.bottom+2;var u=n.left+n.width/2;if(l+r.height>a){l=n.top-2-r.height}if(u+r.width>i){u=i-r.width}return{top:l,left:u}}},{key:"getPopoverPosition",value:function t(e,o){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:5;var r=e.getBoundingClientRect();var i=o.getBoundingClientRect();var a=r.bottom+n;var s=r.left;if(s+i.width>window.innerWidth){s=window.innerWidth-i.width-n}if(a+i.height>window.innerHeight){a=r.top-i.height-n}s=Math.max(s,n);a=Math.max(a,n);return{top:a,left:s}}},{key:"closeNoteForm",value:function t(e){var o=wp.i18n.__;var n=document.querySelector(".tutor-lesson-note-form-wrapper:not(.tutor-d-none)");if(n){n.classList.add("tutor-d-none");var r=n.querySelector('textarea[name="note_text"]');if(r){r.value=""}var i=n.querySelector('input[name="action"]');if(i){i.value="tutor_pro_save_lesson_note"}var a=n.querySelector('input[name="note_id"]');if(a){a.value=""}var s=n.querySelector('input[name="highlight_text"]');if(s){s.value=""}var l=n.querySelector('input[name="highlight_serialized"]');if(l){l.value=""}var u=n.querySelector('input[name="video_start_time"]');if(u){u.value=""}var c=n.querySelector(".tutor-lesson-note-start-time");if(c){c.classList.add("tutor-d-none");c.textContent="00:00 -"}var d=document.querySelector(".tutor-lesson-note-form-title");if(d){d.textContent=o("Take Note","tutor-pro")}var f=n.querySelector(".tutor-lesson-notes-form-key-hint");if(f){f.parentElement.classList.add("tutor-justify-end");f.parentElement.classList.remove("tutor-justify-between");f.classList.add("tutor-d-none")}var v=document.querySelectorAll(".tutor-highlighted.has-popover");v.forEach(function(t){return t.classList.remove("has-popover")});document.body.classList.remove("tutor-modal-open")}var h=document.getElementById("tutor-take-lesson-note-btn");if(h){h.classList.add("tutor-d-none")}if(e){var p=document.querySelector(".tutor-highlighted:not(.has-note)");if(p&&p.tagName.toLowerCase()==="mark"){var m=p.parentNode;while(p.firstChild){m.insertBefore(p.firstChild,p)}m.removeChild(p);m.normalize()}}}},{key:"isNoteFormOpen",value:function t(){var e=document.querySelector(".tutor-lesson-note-form-wrapper");return e&&!e.classList.contains("tutor-d-none")}},{key:"highlightLessonContent",value:function t(e){var o=JSON.parse(e.highlight_serialized);this.highlighter.applyHighlightAtPosition(o.startPos,e)}},{key:"setupEventListeners",value:function t(){var e=this;document.addEventListener("submit",function(t){if(t.target&&t.target.classList.contains("tutor-lesson-notes-form")){e.handleFormSubmission(t)}});document.addEventListener("click",function(t){var o=t.target;if(o.classList.contains("tutor-read-more-less")){e.handleReadMoreLess(o)}if(o.classList.contains("tutor-edit-note-button")||o.closest(".tutor-edit-note-button")){e.handleNoteEdit(t,o)}if(o.classList.contains("tutor-cancel-edit-note-button")||o.closest(".tutor-cancel-edit-note-button")){e.handleCancelNoteEdit(t,o)}if(o.classList.contains("tutor-cancel-note-button")||o.closest(".tutor-cancel-note-button")){e.handleCancelNote(t,o)}if(o.classList.contains("tutor-delete-note-button")||o.closest(".tutor-delete-note-button")){e.handleDeleteNotePopover(t,o)}if(o.classList.contains("tutor-confirm-delete-note-button")||o.closest(".tutor-confirm-delete-note-button")){e.handleConfirmDeleteNote(t,o)}if(o.id==="tutor-take-lesson-note-btn"||o.closest("#tutor-take-lesson-note-btn")){e.handleTakeNoteButton(o)}if(o.id==="tutor-lesson-nav-take-note-btn"||o.closest("#tutor-lesson-nav-take-note-btn")){e.handleLessonNavTakeNoteButton(o)}if(o.matches(".tutor-lesson-note-list-item-video-action")||o.closest(".tutor-lesson-note-list-item-video-action")){e.handleVideoAction(o)}if(o.matches("[data-action-close]")||o.closest("[data-action-close]")){e.closeNoteForm(true)}if(o.id==="tutor-load-more-notes-button"||o.closest("#tutor-load-more-notes-button")){e.handleLoadMoreNotes(t,o)}if(o.closest(".tutor-highlighted.has-note")){e.handleHighlightedTextClick(t,o.closest(".tutor-highlighted.has-note"))}if(o.matches(".tutor-note-popover-edit-button")||o.closest(".tutor-note-popover-edit-button")){e.handleNotePopoverEdit(t,o)}});document.addEventListener("click",function(t){e.handleOutsideClick(t)});document.addEventListener("keydown",function(t){e.handleKeydown(t)});document.addEventListener("mouseup",function(){e.handleMouseup()});["scroll","resize"].forEach(function(t){window.addEventListener(t,function(){e.handleScrollResize()})});document.addEventListener("focusin",function(t){e.handleFocusin(t)});document.addEventListener("tutor_tab_changed",function(t){e.handleTutorTabChanged(t)});document.addEventListener("mouseover",function(t){e.handleNoteHover(t)});document.addEventListener("mouseout",function(t){e.handleNoteHoverOut(t)});window.addEventListener("tutorLessonPlayerReady",function(t){e.handleTutorLessonPlayerReady(t)});document.addEventListener("input",function(t){e.handleTextareaInput(t)})}},{key:"handleFormSubmission",value:function(){var t=w(b().m(function t(e){var o,n,r,i,a,s,l,u,c,d,f,v,h,g,y,_,k,w,S,L,x,E,C,N,T,P,q,O,A,F;return b().w(function(t){while(1)switch(t.p=t.n){case 0:o=wp.i18n.__;if(!(e.target&&e.target.classList.contains("tutor-lesson-notes-form"))){t.n=22;break}e.preventDefault();n=e.target;r=new FormData(n);i=r.get("note_text");a=r.get("lesson_id");s=r.get("note_id");l=r.get("highlight_text");u=r.get("video_start_time");c=window.tutorLessonPlayer;if(c&&typeof c.currentTime==="number"){if(n.hasAttribute("is-main-form")&&!u){r.set("video_start_time",Math.floor(c.currentTime))}r.append("video_end_time",Math.floor(c.currentTime))}if(i){t.n=1;break}tutor_toast(o("Failed","tutor-pro"),o("Note text cannot be empty","tutor-pro"),"error");return t.a(2);case 1:if(a){t.n=2;break}tutor_toast(o("Failed","tutor-pro"),o("Invalid lesson, please try again","tutor-pro"),"error");return t.a(2);case 2:d=n.querySelector("button[type=submit]");t.p=3;d.setAttribute("disabled",true);d.classList.add("is-loading");t.n=4;return m(r);case 4:f=t.v;t.n=5;return f.json();case 5:v=t.v;h=v.status_code;g=v.message;y=v.data;if(!(h===200)){t.n=18;break}tutor_toast(o("Success","tutor-pro"),g||o("Note saved successfully","tutor-pro"),"success");this.closeNoteForm(true);if(s){t.n=11;break}n.reset();if(l&&y&&y.highlight_serialized){this.highlightLessonContent(y)}_=document.querySelector(".tutor-lesson-note-list-wrapper");if(!_){t.n=10;break}t.p=6;t.n=7;return m(p({action:"tutor_pro_get_lesson_notes_html",lesson_id:a}));case 7:w=t.v;t.n=8;return w.json();case 8:S=t.v;if(S.status_code===200&&(k=S.data)!==null&&k!==void 0&&k.html){_.innerHTML=(L=S.data)===null||L===void 0?void 0:L.html}t.n=10;break;case 9:t.p=9;O=t.v;console.error("Failed to fetch updated notes:",O);case 10:t.n=17;break;case 11:x=document.getElementById("tutor-lesson-note-list-item-".concat(s));E=x===null||x===void 0?void 0:x.parentElement;if(!E){t.n=16;break}t.p=12;t.n=13;return m(p({action:"tutor_pro_get_single_lesson_note_html",lesson_id:a,note_id:s}));case 13:N=t.v;t.n=14;return N.json();case 14:T=t.v;if(T.status_code===200&&(C=T.data)!==null&&C!==void 0&&C.html){E.outerHTML=(P=T.data)===null||P===void 0?void 0:P.html}t.n=16;break;case 15:t.p=15;A=t.v;console.error("Failed to fetch updated note:",A);case 16:q=document.querySelectorAll('mark[data-note-id="'.concat(s,'"]'));q.forEach(function(t){t.dataset.noteContent=i});case 17:t.n=19;break;case 18:tutor_toast(o("Failed","tutor-pro"),g||this.defaultErrorMessage,"error");case 19:t.n=21;break;case 20:t.p=20;F=t.v;tutor_toast(o("Failed","tutor-pro"),this.defaultErrorMessage,"error");case 21:t.p=21;d.removeAttribute("disabled");d.classList.remove("is-loading");return t.f(21);case 22:return t.a(2)}},t,this,[[12,15],[6,9],[3,20,21,22]])}));function e(e){return t.apply(this,arguments)}return e}()},{key:"handleReadMoreLess",value:function t(e){var o=e.closest(".tutor-lesson-note-list-item");if(o){var n=o.querySelector(".tutor-lesson-note-content-short");var r=o.querySelector(".tutor-lesson-note-content-long");if(n&&r){var i=!n.classList.contains("tutor-d-none");if(i){n.classList.add("tutor-d-none");r.classList.remove("tutor-d-none")}else{n.classList.remove("tutor-d-none");r.classList.add("tutor-d-none")}}}}},{key:"handleNoteEdit",value:function t(e,o){e.preventDefault();var n=o.closest(".tutor-lesson-note-list-item");var r=n.nextElementSibling;if(r&&r.classList.contains("tutor-lesson-notes-form")){n.classList.add("tutor-d-none");r.classList.remove("tutor-d-none");var i=r.querySelector('textarea[name="note_text"]');if(i){var a=i.value.length;i.focus();i.setSelectionRange(a,a)}}}},{key:"handleCancelNoteEdit",value:function t(e,o){e.preventDefault();var n=o.closest(".tutor-lesson-notes-form");var r=n===null||n===void 0?void 0:n.previousElementSibling;if(r&&n){var i;n.classList.add("tutor-d-none");r.classList.remove("tutor-d-none");var a=((i=n.querySelector('input[name="note_content"]'))===null||i===void 0?void 0:i.value)||"";var s=n.querySelector('textarea[name="note_text"]');if(s){s.value=a}}}},{key:"handleCancelNote",value:function t(e,o){e.preventDefault();var n=o.closest(".tutor-lesson-notes-form");var r=n===null||n===void 0?void 0:n.querySelector(".tutor-lesson-notes-form-buttons");if(r){n.querySelector('textarea[name="note_text"]').value="";r.classList.add("tutor-d-none");var i=n.querySelector(".tutor-lesson-notes-form-key-hint");if(i){i.parentElement.classList.add("tutor-justify-end");i.parentElement.classList.remove("tutor-justify-between");i.classList.add("tutor-d-none")}}}},{key:"handleDeleteNotePopover",value:function t(e,o){var n=wp.i18n.__;e.preventDefault();var r=o.closest(".tutor-delete-note-button")||o;var i=r===null||r===void 0?void 0:r.getAttribute("data-note-id");var a=r===null||r===void 0?void 0:r.getAttribute("data-lesson-id");if(!i){tutor_toast(n("Failed","tutor-pro"),n("Invalid note, please try again","tutor-pro"),"error");return}var s=document.querySelector(".tutor-delete-note-popover");if(s){s.remove()}var l=document.createElement("div");l.className="tutor-delete-note-popover";l.innerHTML='\n            <div class="tutor-delete-note-popover-container">\n                <div class="tutor-delete-note-popover-top">\n                    <div class="tutor-delete-note-popover-content">\n                        <h3>'.concat(n("Delete This Note?","tutor-pro"),"</h3>\n                        <p>").concat(n("Are you sure you want to delete this note permanently?","tutor-pro"),'</p>\n                    </div>\n                    <button class="tutor-delete-note-popover-close"><i class="tutor-icon-times-o"></i></button>\n                </div>\n                <div class="tutor-delete-note-popover-buttons">\n                    <button class="tutor-btn tutor-color-subdued tutor-btn-sm tutor-cancel-delete-popover">').concat(n("Cancel","tutor-pro"),'</button>\n                    <button class="tutor-btn tutor-btn-danger tutor-btn-sm tutor-confirm-delete-note-button" data-note-id="').concat(i,'" data-lesson-id="').concat(a,'">').concat(n("Delete","tutor-pro"),"</button>\n                </div>\n            </div>\n        ");document.body.appendChild(l);var u=r.closest(".tutor-lesson-note-list-item");u===null||u===void 0||u.classList.add("is-focused");var c=document.documentElement.dir==="rtl";var d=u.getBoundingClientRect();var f=l.getBoundingClientRect();l.style.position="absolute";l.style.top="".concat(d.top+window.scrollY+5,"px");if(c){l.style.left="".concat(d.left+window.scrollX+5,"px")}else{l.style.left="".concat(d.right+window.scrollX-f.width-5,"px")}l.style.zIndex="9999";var v=l.querySelector(".tutor-cancel-delete-popover");if(v){v.addEventListener("click",function(){var t;l.remove();(t=r.closest(".tutor-lesson-note-list-item"))===null||t===void 0||t.classList.remove("is-focused")})}var h=l.querySelector(".tutor-delete-note-popover-close");if(h){h.addEventListener("click",function(){var t;l.remove();(t=r.closest(".tutor-lesson-note-list-item"))===null||t===void 0||t.classList.remove("is-focused")})}var p=function t(e){if(!l.contains(e.target)&&e.target!==r){var o;l.remove();(o=r.closest(".tutor-lesson-note-list-item"))===null||o===void 0||o.classList.remove("is-focused");document.removeEventListener("click",p)}};setTimeout(function(){return document.addEventListener("click",p)},0)}},{key:"handleConfirmDeleteNote",value:function(){var t=w(b().m(function t(e,o){var n,r,i,a,s,l,u,c,d,f,v,h,g,y,_,k,w;return b().w(function(t){while(1)switch(t.p=t.n){case 0:n=wp.i18n.__;e.preventDefault();r=o.closest(".tutor-confirm-delete-note-button");i=r===null||r===void 0?void 0:r.getAttribute("data-note-id");if(i){t.n=1;break}tutor_toast(n("Failed","tutor-pro"),n("Invalid note, please try again","tutor-pro"),"error");return t.a(2);case 1:t.p=1;r.setAttribute("disabled",true);r.classList.add("is-loading");t.n=2;return m(p({action:"tutor_pro_delete_lesson_note",note_id:i}));case 2:a=t.v;t.n=3;return a.json();case 3:s=t.v;l=s.status_code;u=s.message;if(!(l===200)){t.n=9;break}tutor_toast(n("Success","tutor-pro"),u||n("Note deleted successfully","tutor-pro"),"success");c=document.querySelector(".tutor-delete-note-popover");if(c){c.remove()}d=document.querySelector(".tutor-note-popover");if(d){d.remove();document.body.classList.remove("tutor-modal-open")}f=document.querySelectorAll('[data-note-id="'.concat(i,'"]'));f.forEach(function(t){if(t.tagName.toLowerCase()==="mark"){var e=t.parentNode;while(t.firstChild){e.insertBefore(t.firstChild,t)}e.removeChild(t);e.normalize()}});v=document.querySelector("#tutor-lesson-note-list-item-".concat(i));if(v){v.parentElement.remove()}h=document.querySelector(".tutor-lesson-note-list-wrapper");if(!h){t.n=8;break}t.p=4;t.n=5;return m(p({action:"tutor_pro_get_lesson_notes_html",lesson_id:r.getAttribute("data-lesson-id")}));case 5:g=t.v;t.n=6;return g.json();case 6:y=t.v;if(y.status_code===200){h.innerHTML=((_=y.data)===null||_===void 0?void 0:_.html)||null}t.n=8;break;case 7:t.p=7;k=t.v;console.error("Failed to fetch updated notes:",k);case 8:t.n=10;break;case 9:tutor_toast(n("Failed","tutor-pro"),u||this.defaultErrorMessage,"error");case 10:t.n=12;break;case 11:t.p=11;w=t.v;tutor_toast(n("Failed","tutor-pro"),this.defaultErrorMessage,"error");case 12:t.p=12;r.removeAttribute("disabled");r.classList.remove("is-loading");return t.f(12);case 13:return t.a(2)}},t,this,[[4,7],[1,11,12,13]])}));function e(e,o){return t.apply(this,arguments)}return e}()},{key:"handleTakeNoteButton",value:function t(e){var o=e.closest("#tutor-take-lesson-note-btn");var n=document.querySelector(".tutor-lesson-note-form-wrapper");var r=this.highlighter.highlightSelection();if(o&&n){n.classList.remove("tutor-d-none");var i=this.getFormPosition(o,n),a=i.top,s=i.left;n.style.top="".concat(a,"px");n.style.left="".concat(s,"px");var l=n.querySelector('textarea[name="note_text"]');if(l){l.focus()}var u=n.querySelector('input[name="highlight_text"]');if(u){u.value=r===null||r===void 0?void 0:r.text}var c=n.querySelector('input[name="highlight_serialized"]');if(c){c.value=JSON.stringify(r)}document.body.classList.add("tutor-modal-open")}}},{key:"handleLessonNavTakeNoteButton",value:function t(e){var o=e.closest("#tutor-lesson-nav-take-note-btn");var n=document.querySelector(".tutor-lesson-note-form-wrapper");if(o&&n){n.classList.remove("tutor-d-none");var r=this.getFormPosition(o,n),i=r.top,a=r.left;n.style.top="".concat(i,"px");n.style.left="".concat(a,"px");var s=n.querySelector('textarea[name="note_text"]');if(s){s.focus()}document.body.classList.add("tutor-modal-open");var l=window.tutorLessonPlayer;if(l&&typeof l.currentTime==="number"){var u=Math.floor(l.currentTime);var c=n.querySelector('input[name="video_start_time"]');if(c){c.value=u}var d=n.querySelector(".tutor-lesson-note-start-time");if(d){var f=Math.floor(u/60);var v=u%60;d.textContent="".concat(f.toString().padStart(2,"0"),":").concat(v.toString().padStart(2,"0")," -");d.classList.remove("tutor-d-none")}}}}},{key:"handleVideoAction",value:function t(e){var o=e.closest(".tutor-lesson-note-list-item-video-action");if(!o)return;var n=o.getAttribute("data-start-time");var r=window.tutorLessonPlayer;if(r&&n){var i=document.querySelector(".tutor-video-player-wrapper");if(i){i.scrollIntoView({behavior:"smooth",block:"center"})}r.currentTime=Number(n);r.play()}}},{key:"handleLoadMoreNotes",value:function(){var t=w(b().m(function t(e,o){var n,r,i,a,s,l,u,c,d,f,v,h;return b().w(function(t){while(1)switch(t.p=t.n){case 0:n=wp.i18n.__;e.preventDefault();r=o;i=r.getAttribute("data-lesson-id");a=r.getAttribute("data-items-per-page")||20;s=document.querySelectorAll(".tutor-lesson-note-list-item").length||0;if(i){t.n=1;break}tutor_toast(n("Failed","tutor-pro"),n("Invalid lesson, please try again","tutor-pro"),"error");return t.a(2);case 1:t.p=1;r.setAttribute("disabled",true);r.classList.add("is-loading");t.n=2;return m(p({action:"tutor_pro_lesson_notes_load_more",lesson_id:i,offset:s}));case 2:l=t.v;t.n=3;return l.json();case 3:u=t.v;c=u.status_code;d=u.data;f=u.message;if(c===200&&d!==null&&d!==void 0&&d.html){v=document.querySelector(".tutor-lesson-note-list");if(v){v.insertAdjacentHTML("beforeend",d.html)}if(d.notes_count<a){r.classList.add("tutor-d-none")}else{r.classList.remove("tutor-d-none")}}else{tutor_toast(n("Failed","tutor-pro"),f||this.defaultErrorMessage,"error")}t.n=5;break;case 4:t.p=4;h=t.v;tutor_toast(n("Failed","tutor-pro"),this.defaultErrorMessage,"error");case 5:t.p=5;r.removeAttribute("disabled");r.classList.remove("is-loading");return t.f(5);case 6:return t.a(2)}},t,this,[[1,4,5,6]])}));function e(e,o){return t.apply(this,arguments)}return e}()},{key:"handleHighlightedTextClick",value:function t(e,o){o.classList.add("has-popover");var n=o.getAttribute("data-note-id");var r=o.getAttribute("data-lesson-id");var i=o.getAttribute("data-note-content");var a=o.getAttribute("data-highlight-text");if(n){var s=document.querySelector(".tutor-note-popover");if(s){s.remove()}var l=document.createElement("div");l.className="tutor-note-popover";l.innerHTML='\n                <div class="tutor-note-popover-content">\n                    <div class="tutor-note-popover-top">\n                        <div class="tutor-note-popover-highlight"></div>\n                        <button class="tutor-note-popover-close"><i class="tutor-icon-times-o"></i></button>\n                    </div>\n                    <div class="tutor-note-popover-note">'.concat(i,'</div>\n                    <div class="tutor-note-popover-buttons">\n                        <button class="tutor-btn tutor-note-popover-edit-button"><i class="tutor-icon-edit"></i></button>\n                        <button class="tutor-btn tutor-confirm-delete-note-button" data-note-id="').concat(n,'" data-lesson-id="').concat(r,'">\n                            <i class="tutor-icon-trash-can-line"></i>\n                        </button>\n                    </div>\n                </div>\n            ');var u=l.querySelector(".tutor-note-popover-highlight");u.textContent=a;document.body.appendChild(l);document.body.classList.add("tutor-modal-open");var c=this.getPopoverPosition(e.target,l),d=c.top,f=c.left;l.style.position="fixed";l.style.top="".concat(d,"px");l.style.left="".concat(f,"px");l.style.zIndex="9999";var v=l.querySelector(".tutor-note-popover-close");if(v){v.addEventListener("click",function(){o.classList.remove("has-popover");l.remove();document.body.classList.remove("tutor-modal-open")})}var h=function t(n){if(!l.contains(n.target)&&n.target!==e.target){o.classList.remove("has-popover");l.remove();document.removeEventListener("click",h)}var r=document.querySelector(".tutor-note-popover");var i=document.querySelector(".tutor-lesson-note-form-wrapper:not(.tutor-d-none)");if(!r&&!i){document.body.classList.remove("tutor-modal-open")}};setTimeout(function(){return document.addEventListener("click",h)},0)}}},{key:"handleNotePopoverEdit",value:function t(e,o){e.preventDefault();var n=wp.i18n.__;var r=o.closest(".tutor-note-popover");var i=r.querySelector(".tutor-confirm-delete-note-button").getAttribute("data-note-id");if(i){r.remove();var a=document.querySelector(".tutor-lesson-note-form-wrapper");var s=document.querySelector('mark[data-note-id="'.concat(i,'"]'));if(a&&s){a.classList.remove("tutor-d-none");var l=this.getPopoverPosition(s,a),u=l.top,c=l.left;a.style.top="".concat(u,"px");a.style.left="".concat(c,"px");var d=a.querySelector('textarea[name="note_text"]');if(d){var f=r.querySelector(".tutor-note-popover-note").textContent;d.value=f;d.focus()}var v=a.querySelector('input[name="note_id"]');if(v){v.value=i}var h=a.querySelector('input[name="action"]');if(h){h.value="tutor_pro_update_lesson_note"}var p=document.querySelector(".tutor-lesson-note-form-title");if(p){p.textContent=n("Edit Note","tutor-pro")}document.body.classList.add("tutor-modal-open")}}}},{key:"handleOutsideClick",value:function t(e){var o=window.getSelection();if(o&&!o.isCollapsed){return}var n=[".tutor-lesson-note-form-wrapper","#tutor-take-lesson-note-btn","#tutor-lesson-nav-take-note-btn",".tutor-note-popover-edit-button"];if(!e.target.closest(n.join(","))){this.closeNoteForm(true)}}},{key:"handleKeydown",value:function t(e){if(e.key==="Escape"){var o=document.querySelector(".tutor-lesson-note-form-wrapper");if(o&&!o.classList.contains("tutor-d-none")){this.closeNoteForm(true)}var n=document.querySelector(".tutor-note-popover");if(n){n.remove();document.body.classList.remove("tutor-modal-open")}var r=document.querySelectorAll(".tutor-highlighted.has-popover");r.forEach(function(t){return t.classList.remove("has-popover")})}if(e.target&&e.target.matches(".tutor-lesson-notes-form textarea")){if((e.ctrlKey||e.metaKey)&&e.key==="Enter"){e.preventDefault();var i=e.target.closest("form");if(i){i.dispatchEvent(new Event("submit",{cancelable:true,bubbles:true}))}}}}},{key:"handleMouseup",value:function t(){var e=document.getElementById("tutor-take-lesson-note-btn");var o=this.getSelectionEndPosition();if(o&&e){e.classList.remove("tutor-d-none");e.style.top="".concat(o.y-54,"px");e.style.left="".concat(o.x-e.clientWidth/2,"px")}}},{key:"handleScrollResize",value:function t(){var e=document.getElementById("tutor-take-lesson-note-btn");if(e&&!e.classList.contains("tutor-d-none")){var o=this.getSelectionEndPosition();if(o){e.style.top="".concat(o.y-54,"px");e.style.left="".concat(o.x-e.clientWidth/2,"px")}}}},{key:"handleFocusin",value:function t(e){if(e.target&&e.target.matches(".tutor-notes-tab-content-form textarea")){var o=e.target.closest(".tutor-notes-tab-content-form").querySelector(".tutor-lesson-notes-form-buttons");if(o){o.classList.remove("tutor-d-none")}}}},{key:"handleNoteHover",value:function t(e){var o=e.target.dataset.noteId;if(!o)return;var n=document.querySelectorAll('.tutor-highlighted[data-note-id="'.concat(o,'"]'));n.forEach(function(t){return t.classList.add("note-hover")})}},{key:"handleNoteHoverOut",value:function t(e){var o=e.target.dataset.noteId;if(!o)return;var n=document.querySelectorAll('.tutor-highlighted[data-note-id="'.concat(o,'"]'));n.forEach(function(t){return t.classList.remove("note-hover")})}},{key:"handleTutorTabChanged",value:function t(e){this.closeNoteForm();var o=document.getElementById("tutor-lesson-nav-take-note-btn");if(o){if(e.detail&&e.detail.tabId==="tutor-course-spotlight-notes"){o.classList.add("tutor-d-none")}else{o.classList.remove("tutor-d-none")}}}},{key:"handleTutorLessonPlayerReady",value:function t(e){var o=this;var n=e.detail.player;if(n){var r=false;n.on("enterfullscreen",function(t){var e=t.srcElement;var o=document.querySelector("#tutor-lesson-nav-take-note-btn");var n=document.querySelector(".tutor-lesson-note-form-wrapper");if(e&&o&&n){o.classList.add("tutor-video-lesson-take-note-button");if(o.classList.contains("tutor-d-none")){o.classList.remove("tutor-d-none");r=true}e.appendChild(o);n.classList.add("tutor-player-fullscreen");e.appendChild(n);var i=document.createElement("div");i.classList.add("tutor-toast-parent","tutor-toast-left");e.appendChild(i)}});n.on("exitfullscreen",function(t){var e=t.srcElement;var n=document.querySelector(".tutor-course-spotlight-nav");var i=document.querySelector(".tutor-course-spotlight-tab");var a=document.querySelector("#tutor-lesson-nav-take-note-btn");var s=document.querySelector(".tutor-lesson-note-form-wrapper");if(n&&i&&a&&s){a.classList.remove("tutor-video-lesson-take-note-button");if(r){a.classList.add("tutor-d-none");r=false}n.appendChild(a);s.classList.remove("tutor-player-fullscreen");i.appendChild(s)}var l=document.querySelector(".tutor-toast-parent");if(l&&e){e.removeChild(l)}if(o.isNoteFormOpen()){o.closeNoteForm(false)}})}}},{key:"handleTextareaInput",value:function t(e){if(e.target&&e.target.matches('.tutor-lesson-notes-form textarea[name="note_text"]')){var o=e.target.closest(".tutor-lesson-notes-form");if(o){var n=o.querySelector(".tutor-lesson-notes-form-key-hint");if(n){if(e.target.value.trim().length>0){n.parentElement.classList.remove("tutor-justify-end");n.parentElement.classList.add("tutor-justify-between");n.classList.remove("tutor-d-none")}else{n.parentElement.classList.add("tutor-justify-end");n.parentElement.classList.remove("tutor-justify-between");n.classList.add("tutor-d-none")}}}}}}])}();window.addEventListener("DOMContentLoaded",function(){new N})})();